{# navbar #}

{% macro navbar_links() %}
{% if g.user %}
<a href="/">Files</a>
<a href="/edit">New File</a>
<a href="/upload?dir={{ request.args.get("dir", "") }}">Upload</a>
<a href="/git-clone?dir={{ request.args.get("dir", "") }}">Git Clone</a>
<a href="/notifications">Notifications</a>
<a href="{{ SCHEME }}://{{ SERVER_NAME }}/">Home</a>
<a href="/logout">Logout</a>
{% else %}
<a href="/login">Login</a>
<a href="/register">Register</a>
{% endif %}
{% endmacro %}

<nav>
    <div style="display: flex; align-items: center;">
        <a href="/"><h1>Dashboard</h1></a>

        <!-- <form class="search-form" action="/search"> -->
        <!--     <input type="search" placeholder="Search..." name="q" value="{{ g.q }}"> -->
        <!--     <button type="submit" id="search-toggle"><img class="icon" src="/static/svg/search.svg"></button> -->
        <!-- </form> -->
    </div>

    <div style="display: flex; align-items: center;">

        <div class="nav-links">
            {{ navbar_links() }}
        </div>
        {% if session.get("username") %}
        <a href="{{ SCHEME }}://{{ SERVER_NAME }}/{{ session["username"] }}">
        <img class="profile-img" src="{{ SCHEME }}://{{ SERVER_NAME }}/dp/{{ session["username"] }}" alt="profile">
        </a>
        {% endif %}
        <button type="button" id="mobile-menu-btn"><img class="icon" src="/static/svg/menu.svg"></i></button>
    </div>
</nav>

<!-- Mobile menu -->
<div id="mobile-menu">
    {{ navbar_links() }}
</div>

<script>
const mobile_menu = document.getElementById('mobile-menu');
const mobile_menu_button = document.getElementById('mobile-menu-btn');
// const search_form = document.querySelector('.search-form');
// const search_toggle = document.getElementById('search-toggle');
// const search_input = search_form.querySelector('input');

mobile_menu_button.addEventListener('click', () => {
    if (mobile_menu.style.left === '0px') {
        mobile_menu.style.left = '100%';
        mobile_menu_button.innerHTML = `<img class="icon" src="/static/svg/menu.svg">`;
    } else {
        mobile_menu.style.left = '0px';
        mobile_menu_button.innerHTML = `<img class="icon" src="/static/svg/x.svg">`;
    }
});

/*
search_toggle.addEventListener('click', (e) => {
    if (window.innerWidth <= 768) {
        if (!search_form.classList.contains('expanded')) {
            search_form.classList.toggle('expanded');
            search_input.focus();
            e.preventDefault();
        }
    }
});
*/
</script>
